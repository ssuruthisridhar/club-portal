
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard | Club Portal</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<style>
body {
  font-family: 'Segoe UI', sans-serif;
  background: #f5f7fa;
}
.navbar {
  background: #343a40;
}
.navbar a {
  color: white;
}
.navbar a:hover {
  text-decoration: underline;
}
.event-card {
  background: white;
  padding: 15px;
  border-radius: 10px;
  margin-bottom: 15px;
}
.event-card img {
  width: 100%;
  border-radius: 8px;
}
</style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark">
<div class="container-fluid">
<a class="navbar-brand" href="#">‚öôÔ∏è Admin Dashboard</a>
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarNav">
<ul class="navbar-nav ms-auto">
<li class="nav-item"><a class="nav-link" href="#" onclick="showHome()">Home</a></li>
<li class="nav-item"><a class="nav-link" href="#" onclick="showEvents()">Events</a></li>
<li class="nav-item"><a class="nav-link" href="#" onclick="showRegistrations()">Registrations</a></li>
<li class="nav-item"><a class="nav-link" href="#" id="logoutLink">Logout</a></li>
</ul>
</div>
</div>
</nav>

<!-- Home Section -->
<div class="container mt-3" id="homeSection" style="display:none;">
<h2>üìã All Events</h2>
<div id="eventsList" class="row"></div>
</div>

<!-- Events Section -->
<div class="container mt-3" id="eventsSection" style="display:none;">
<h2>‚ûï Add New Event</h2>
<form id="eventForm" class="mb-4">
<input type="hidden" id="editIndex">
<div class="mb-3">
<input type="text" id="title" class="form-control" placeholder="Event Title" required>
</div>
<div class="mb-3">
<input type="date" id="date" class="form-control" required>
</div>
<div class="mb-3">
<textarea id="description" class="form-control" placeholder="Description"></textarea>
</div>
<div class="mb-3">
<input type="file" id="image" accept="image/*">
</div>
<button type="submit" class="btn btn-success">Save Event</button>
</form>
<div id="imagePreview"></div>
</div>

<!-- Registrations Section -->
<div class="container mt-3" id="registrationsSection" style="display:none;">
<h2>üë• Student Registrations</h2>
<ul id="memberList" class="list-group"></ul>
</div>

<script>
const role = localStorage.getItem("role");
if (role !== "admin") {
  alert("‚ùå Access denied. Admins only.");
  window.location.href = "login.html";
}

document.getElementById("logoutLink").addEventListener("click", e => {
  e.preventDefault();
  localStorage.clear();
  window.location.href = "login.html";
});

let events = JSON.parse(localStorage.getItem("events")) || [];
let registrations = JSON.parse(localStorage.getItem("registrations")) || [];

// Show sections based on navbar click
function showHome() {
  document.getElementById("homeSection").style.display = "block";
  document.getElementById("eventsSection").style.display = "none";
  document.getElementById("registrationsSection").style.display = "none";
  renderEvents();
}
function showEvents() {
  document.getElementById("homeSection").style.display = "none";
  document.getElementById("eventsSection").style.display = "block";
  document.getElementById("registrationsSection").style.display = "none";
}
function showRegistrations() {
  document.getElementById("homeSection").style.display = "none";
  document.getElementById("eventsSection").style.display = "none";
  document.getElementById("registrationsSection").style.display = "block";
  renderRegistrations();
}

// Render events list
function renderEvents() {
  const container = document.getElementById("eventsList");
  container.innerHTML = "";
  if (events.length === 0) {
    container.innerHTML = "<p>No events found</p>";
    return;
  }
  events.forEach((event, index) => {
    const card = document.createElement("div");
    card.className = "col-md-4";
    card.innerHTML = `
      <div class="event-card">
        <img src="${event.imageUrl || 'https://via.placeholder.com/250x150'}">
        <h3>${event.title}</h3>
        <p>${event.description}</p>
        <p class="date">üìÖ ${event.date}</p>
        <button class="btn btn-warning" onclick="editEvent(${index})">‚úèÔ∏è Edit</button>
        <button class="btn btn-danger" onclick="deleteEvent(${index})">üóë Delete</button>
      </div>
    `;
    container.appendChild(card);
  });
}

// Render registrations
function renderRegistrations() {
  const list = document.getElementById("memberList");
  list.innerHTML = "";
  if (registrations.length === 0) {
    list.innerHTML = "<p>No registrations found.</p>";
    return;
  }
  registrations.forEach((r, i) => {
    const li = document.createElement("li");
    li.className = "list-group-item";
    li.innerHTML = `<strong>${r.name}</strong> (${r.email}) ‚Üí ${r.event}`;
    list.appendChild(li);
  });
}

// Image preview
document.getElementById("image").addEventListener("change", function() {
  const file = this.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = e => {
      document.getElementById("imagePreview").innerHTML = `<img src="${e.target.result}" style="max-width:200px;border-radius:8px;">`;
    };
    reader.readAsDataURL(file);
  }
});

// Save/Add event
document.getElementById("eventForm").addEventListener("submit", e => {
  e.preventDefault();
  const title = document.getElementById("title").value;
  const date = document.getElementById("date").value;
  const description = document.getElementById("description").value;
  const file = document.getElementById("image").files[0];
  const editIndex = document.getElementById("editIndex").value;

  const reader = new FileReader();
  reader.onload = ev => {
    const eventObj = { title, date, description, imageUrl: ev.target.result };
    if (editIndex !== "") {
      events[editIndex] = eventObj;
    } else {
      events.push(eventObj);
    }
    localStorage.setItem("events", JSON.stringify(events));
    document.getElementById("eventForm").reset();
    document.getElementById("imagePreview").innerHTML = "";
    document.getElementById("editIndex").value = "";
    showHome();
  };
  if (file) {
    reader.readAsDataURL(file);
  } else {
    const eventObj = { title, date, description, imageUrl: events[editIndex]?.imageUrl || "" };
    if (editIndex !== "") {
      events[editIndex] = eventObj;
    } else {
      events.push(eventObj);
    }
    localStorage.setItem("events", JSON.stringify(events));
    showHome();
  }
});

function editEvent(index) {
  document.getElementById("title").value = events[index].title;
  document.getElementById("date").value = events[index].date;
  document.getElementById("description").value = events[index].description;
  document.getElementById("imagePreview").innerHTML = `<img src="${events[index].imageUrl}" style="max-width:200px;border-radius:8px;">`;
  document.getElementById("editIndex").value = index;
  showEvents();
}

function deleteEvent(index) {
  if (confirm("Are you sure you want to delete this event?")) {
    events.splice(index, 1);
    localStorage.setItem("events", JSON.stringify(events));
    renderEvents();
  }
}

// Initial load ‚Üí show home
showHome();
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

